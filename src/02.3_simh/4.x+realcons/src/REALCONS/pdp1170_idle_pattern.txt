IDLE PATTERNS
-

1) For RSX11 and 2.11BSD:
The "idle pattern" is displayed with  DATA SELECT KNOB in DATA PATH position.
This displays the R0 content with a WAIT statement.


2) For IAS (Lee Gleason)

This is the code:

007134  tst     003020
007140  bne     007212
007142  mov     #000004,003020     ; prescaler down to zero: update pattern
007150  bis     #000100,177776
007156  jsr     pc,025154
007162  mov     003022,r0
007166  clc
007170  bmi     007174
007172  sec
007174  rol     r0
007176  mov     r0,003022
007202  mov     #034000,-(sp)
007206  jsr     pc,003040
007212  mov     003022,r0       ; should define "DATAPATH_shifter"
007216  dec     003020          ; must not influence "DATAPATH_shifter" !
007222  wait
007224  br      007134

    "wait" is triggered on clock interrupt
    Word 003020  is a prescaler and counts 3,2,1,10
    Word 003022  contains the current pattern to display


"
 I checked and the knobs were in the right positions. I'm actually old enough to have worked with an 11/70
with a front panel, so I remembered where the controls had to be to see the idle loop.

 Unfortunately, I can't distribute the IAS disk. IAS doesn't come with sources ether, but, I used E11 to trace
the idle loop and came up with this.

007134  tst     003020
007140  bne     007212
007142  mov     #000004,003020
007150  bis     #000100,177776
007156  jsr     pc,025154
007162  mov     003022,r0
007166  clc
007170  bmi     007174
007172  sec
007174  rol     r0
007176  mov     r0,003022
007202  mov     #034000,-(sp)
007206  jsr     pc,003040
007212  mov     003022,r0
007216  dec     003020
007222  wait
007224  br      007134

 Like RSX11M, it does a WAIT instruction, waiting for the clock interrupt. Then, every 4th interrupt, it
rotates a pattern left, as well as doing some other timekeeping stuff. That matches what I recall seeing back
when I had a physical 11/70 running IAS - the "snake" would rotate left. Actually, it was even more
interesting than that - I haven't traced the code that does this part, but, if you start the IAS Timesharing
subsystem, the idle pattern changes and rotates right instead of left.


 I'll have to dig further ands ee if I can figure out why this doesn't display correctly - like I said,
instead of the snake, all I see is the lowest two bits blinking.

 I'd like to compliment you on the work you've done here - this is a very well designed, well coded and
capable project - I wish the commerical software I have to deal with was half as good.



-----Original Message----- From: Jörg Hoppe
Sent: Monday, May 09, 2016 12:34 AM
To: Lee Gleason
Subject: Re: 11/70 SIMH console display

Lee,

thanks for testing with IAS!

Making the "idle pattern" work was result of own investigation,
There was neither docs nor a real machine nor even a good video
available, and I only developed on RSX.

Apparently the idle pattern is not generated by writing into the PDP-11
Display Register (at least under RSX). The DATA SELECT knob must be in
the "DATA PATHS" position, then the pattern is generated by the output
of the 11/70 ALU.
Simh was extended to emulate this point in the circuitry. See signal
"ALU_result" in
...\projects\02.3_simh.4.x.jh\src\REALCONS\realcons_console_pdp11_70.c
and
...\projects\02.3_simh.4.x.jh\src\pdp11/pdp11_cpu.c

With this "bare-metal" implementation SUPERVISOR mode shouldn't matter.


For IAS, the first thing to check is the position of the DATA SELECT
knob for the pattern.
If it is also "DATA PATHS", the emulation of the "ALU_result" signal
must be enhanced, perhaps taking SUPERVISOR mode into account.

Can you point me to your IAS disk and how to run it?
Do you know of a "idle pattern" video where the position of the knobs is
visible?
Is the source code of IAS available?


best regards,
Joerg


Am 08.05.2016 um 23:26 schrieb Lee Gleason:
>
>
>   I downloaded the 11/70 console display system from Github and booted
> RSX11M with it – it was good to see the idle loop pattern again, haven’t
> seen it in years.
>
>   I then booted an IAS-11 disk, and didn’t get the idle pattern I
> excepted to see – it just blinked the lower two bits rapdily, instead of
> displaying the side to side “snake” pattern IAS produces. I’m about to
> dive into the code and see what’s up, but before I do that, I thought
> I’d ask, does the console display fully support supervisor mode? Because
> I think that IAS uses supervisor mode to run the idle loop.
>   Anyway, it looks like a great piece of code – thanks for making it
> available.
>
> --
> Lee K. Gleason N5ZMR
> Control-G Consultants
> lee.gleason@comcast.net <mailto:lee.gleason@comcast.net>


